<ion-header>
    <ion-navbar>
        <ion-title (click)="handleListNameClick()">{{list.name}}</ion-title>
        <ion-buttons end>
            <button ion-button icon-only (click)="handleManageListClick()">
                <ion-icon name="people" color="secondary"></ion-icon>
            </button>
            <button ion-button icon-only>
                <ion-icon name="cloud-done" color="tertiary" [hidden]="isUpdating"></ion-icon>
                <ion-spinner color="tertiary" [hidden]="!isUpdating"></ion-spinner>
            </button>
        </ion-buttons>
    </ion-navbar>
</ion-header>

<ion-content>
    <ion-refresher color="tertiary" (ionRefresh)="refreshList($event)">
        <ion-refresher-content></ion-refresher-content>
    </ion-refresher>
    <ion-list>
        <ion-card *ngFor="let item of list.items">
            <ion-item class="item">
                <ion-checkbox [(ngModel)]="item.state.checked" color="secondary" (ionChange)="handleItemCheck(item)"></ion-checkbox>
                <ion-input class="no-validate" type="text" [ngModel]="item.text" (ionBlur)="updateItem(item, $event.value)" *ngIf="!item.state.checked"></ion-input>
                <ion-label *ngIf="item.state.checked" [ngClass]="{ itemchecked: item.state.checked }">{{item.text}}</ion-label>
                <button ion-button icon-only item-right clear (click)="presentActionSheet(item)">
                    <ion-icon color="tertiary" name="more"></ion-icon>
                </button>
            </ion-item>
        </ion-card>
        <ion-card>
            <ion-item>
                <ion-input type="text" placeholder="+ item" (ionBlur)="onBlur()" [(ngModel)]="newItemName" (keyup.enter)="onBlur()"></ion-input>
            </ion-item>
        </ion-card>
    </ion-list>
</ion-content>